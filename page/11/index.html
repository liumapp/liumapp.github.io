<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('http://www.liumapp.com').hostname,
    root: '/',
    scheme: 'Gemini',
    version: '7.7.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    comments: {"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>

  <meta property="og:type" content="website">
<meta property="og:title" content="liumapp">
<meta property="og:url" content="http://www.liumapp.com/page/11/index.html">
<meta property="og:site_name" content="liumapp">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="liumapp">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://www.liumapp.com/page/11/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: true,
    isPost: false
  };
</script>

  <title>liumapp</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">liumapp</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/liumapp" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.liumapp.com/articles/2017/08/09/1502242821686.html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="liumapp">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="liumapp">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/articles/2017/08/09/1502242821686.html/" class="post-title-link" itemprop="url">修改Github项目的语言分类</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-08-09 09:42:35" itemprop="dateCreated datePublished" datetime="2017-08-09T09:42:35+08:00">2017-08-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2018-04-16 14:00:20" itemprop="dateModified" datetime="2018-04-16T14:00:20+08:00">2018-04-16</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>辛辛苦苦做的一个Java项目，发布到Github上，结果被Github标注为一个Html或者JavaScript项目，这得是一件多郁闷的事情</p>
</blockquote>
<p>先上图，我的DNSBee项目是一个Java项目（管理DNS解析的Web项目），但因为包含的js文件比较多，所以被Github标注为一个JavaScript项目</p>
<p>  <img src="http://oss.fangxinqian.cn/76e05050df9241edafe57c73849ff325.jpg" alt="2.pic.jpg"></p>
<p>现在我要把它的语言分类改为Java：</p>
<p>在项目目录中创建一个名为”.gitattributes”的文件，添加以下代码：</p>
<pre><code>*.js linguist-language=Java</code></pre><p>重新上传到Github上，然后就可以发现乖乖的变回Java了。</p>
<p>  <img src="http://oss.fangxinqian.cn/2400f1c2c4804a64a6de9c47330ead7d.jpg" alt="3.pic.jpg"></p>
<h3 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h3><p>我不是很明白Github的语言识别机制，但是似乎跟项目中所有文件的后缀有关系，如果它把我们的项目标识为JavaScript，那肯定是因为我们项目中以js结尾的文件较多（这在web项目中非常常见），所以只需要通过linguist-language，让Github把js结尾的文件看作java文件就可以达到修改语言类别的目的。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/articles/2017/08/09/1502242821686.html/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.liumapp.com/articles/2017/08/07/1502096593817.html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="liumapp">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="liumapp">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/articles/2017/08/07/1502096593817.html/" class="post-title-link" itemprop="url">负载均衡与环境搭建脚本很配噢</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-08-07 17:03:19" itemprop="dateCreated datePublished" datetime="2017-08-07T17:03:19+08:00">2017-08-07</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>负载均衡，将流量按照每台服务器的权重进行分发，对于这个权重的设置，我一般将值全部设为50，这样可以保证每台服务器节点分担到的流量相当，可是如何来保证每台服务器的抗压能力大致相当呢？硬件性能很重要，但是它的环境软性能更重要。</p>
</blockquote>
<p>保证每台服务器的硬件性能相差不大很容易，在阿里云上购买的时候选择完全相同的配置即可，但如何来保证每台服务器运行的环境一致呢？可以通过环境搭建脚本来实现。</p>
<h3 id="额外的加成"><a href="#额外的加成" class="headerlink" title="额外的加成"></a>额外的加成</h3><ul>
<li><p>系统软件进行更新时可以在原有的脚本上进行（当然，这种情况一般不大可能会出现，但万一呢）</p>
</li>
<li><p>管理人员发生流动后，新来的接任者可以通过原来的安装脚本很快速的熟悉整个集群的环境配置。（至少不会发生找不到程序装在哪里这个问题，为什么说是集群？明明就一个服务器的安装脚本呀，因为其他的机器用的都是同一个脚本嘛…）</p>
</li>
<li><p>系统出错率比手动搭建要低（可能踩的坑都已经在写脚本的过程中踩过了，当然，你也可以认为该来的bug总是要来的，不如让它们提前来）</p>
</li>
</ul>

          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/articles/2017/08/07/1502096593817.html/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.liumapp.com/articles/2017/08/07/1502093791131.html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="liumapp">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="liumapp">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/articles/2017/08/07/1502093791131.html/" class="post-title-link" itemprop="url">CentOS自动化部署LTMJ环境</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-08-07 16:16:42" itemprop="dateCreated datePublished" datetime="2017-08-07T16:16:42+08:00">2017-08-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2017-08-08 09:47:50" itemprop="dateModified" datetime="2017-08-08T09:47:50+08:00">2017-08-08</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>与自动化部署LNMP环境的脚本非常类似，只不过这次是为了部署java项目而写的。</p>
</blockquote>
<h3 id="项目源码"><a href="#项目源码" class="headerlink" title="项目源码"></a>项目源码</h3><p> Github:<a href="https://github.com/liumapp/ltmj" target="_blank" rel="noopener">ltmj</a></p>
<p> 简介：Linux(CentOS)+Tomcat+Mysql+Java环境自动化搭建脚本</p>
<h3 id="安装步骤"><a href="#安装步骤" class="headerlink" title="安装步骤"></a>安装步骤</h3><ul>
<li><p>拷贝项目到服务器上</p>
</li>
<li><p>进入项目目录</p>
</li>
<li><p>执行命令：</p>
<pre><code>chmod -R 777 install.sh env/ ftp/ java/ mysql/ res/ tomcat/</code></pre><p>赋予脚本可执行权限</p>
</li>
<li><p>执行 install.sh</p>
</li>
<li><p>安装结束，输入 java -version检查java是否安装成功，在浏览器访问 “<a href="http://yourserverIp:8080&quot;">http://yourserverIp:8080&quot;</a> 检查tomcat是否安装成功，mysql与ftp如果您希望远程登录的话，请执行相关配置（见注意事项）。</p>
</li>
</ul>
<h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><ul>
<li><p>所有程序都将安装在/alidata目录下</p>
<ul>
<li>/alidata/server : mysql、tomcat、java、openssl的安装位置</li>
</ul>
</li>
<li><p>tomcat的启动命令我暂时没有写入/etc/init.d下，所以你需要自己进入/alidata/server/tomcat/bin目录去执行catalina.sh的start命令。</p>
</li>
<li><p>mysql安装好后默认是不允许外网连接的，如果您希望在本地开发环境下远程连接服务器的mysql服务，请执行以下操作：</p>
<pre><code>* 进入/alidata/server/mysql/bin目录

 * 执行./mysql -u root -p

 * 输入mysql密码

 * use mysql;（请不要丢失&quot;;&quot;）

 * grant all on *.* to root@&quot;%&quot; identified by &quot;yourloginpassword&quot;;

 * flush privileges;

 * exit;</code></pre></li>
<li><p>mysql跟ftp帐号密码请见account.log文件</p>
<pre><code>* 修改mysql账号密码：

   * 进入/alidata/server/mysql/bin目录

   * 执行./mysql -u root -p

   * 输入mysql密码（请见account.log文件）

   * use mysql;（请不要丢失&quot;;&quot;）

   * update user set password=PASSWORD(&apos;yourpassword&apos;) where user=&apos;root&apos;;

   * flush privileges;

   * exit;</code></pre></li>
<li><p>ftp帐号默认是不允许远程登录的，如果需要，请进行以下配置：</p>
<ul>
<li><p>vim /etc/passwd</p>
</li>
<li><p>找到www和ftp这一行，把它们的/sbin/nologin修改为/bin/bash</p>
</li>
<li><p>这个时候如果您还是无法远程建立和ftp的的连接，请检查您的防火墙是否禁止了21端口的监听</p>
</li>
</ul>
</li>
</ul>

          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/articles/2017/08/07/1502093791131.html/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.liumapp.com/articles/2017/08/01/1501577329509.html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="liumapp">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="liumapp">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/articles/2017/08/01/1501577329509.html/" class="post-title-link" itemprop="url">分享：适合编程时听的音乐</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-08-01 16:48:49" itemprop="dateCreated datePublished" datetime="2017-08-01T16:48:49+08:00">2017-08-01</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>最近发现惘闻系列的音乐很适合编程的时候听，完全不影响注意力。</p>
</blockquote>
<p>惘闻(wang wen)</p>
<p><img src="http://oss.fangxinqian.cn/9e2be68920524e5ca63f6b7ff4cd80e8.jpg" alt="1.pic.jpg"></p>
<p>大家还知道有哪些系列的音乐适合编程的时候听嘛？</p>

          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/articles/2017/08/01/1501577329509.html/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.liumapp.com/articles/2017/08/01/1501551825701.html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="liumapp">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="liumapp">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/articles/2017/08/01/1501551825701.html/" class="post-title-link" itemprop="url">CentOS7使用网易的yum镜像源</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-08-01 09:43:45" itemprop="dateCreated datePublished" datetime="2017-08-01T09:43:45+08:00">2017-08-01</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>最近用yum下载gitlab，实在无法忍受默认源的下载速度，便换了网易的，这里记录一下更换的方法。</p>
</blockquote>
<p>首先进入操作目录：</p>
<pre><code>cd /etc/yum.repos.d</code></pre><p>然后我们要备份现有的源文件：</p>
<pre><code>mv CentOS-Base.repo CentOS-Base.repo.default</code></pre><p>下载网易源：</p>
<pre><code>wget -o CentOS-Base.repo http://mirrors.163.com/.help/CentOS7-Base-163.repo</code></pre><p>写入：</p>
<pre><code>cp -rp CentOS7-Base-163.repo CentOS-Base.repo</code></pre><p>赋予权限:</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/articles/2017/08/01/1501551825701.html/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.liumapp.com/articles/2017/07/27/1501137632912.html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="liumapp">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="liumapp">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/articles/2017/07/27/1501137632912.html/" class="post-title-link" itemprop="url">DNSBrood开发日志——CustomAnswerPatternProvider下的HashMap结构调整</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-07-27 14:55:28" itemprop="dateCreated datePublished" datetime="2017-07-27T14:55:28+08:00">2017-07-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2017-07-31 09:15:07" itemprop="dateModified" datetime="2017-07-31T09:15:07+08:00">2017-07-31</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>调整的HashMap，原设计目的是存放要响应客户正向解析请求的DNS记录。调整后目的不变，只不过不再以用户ip为键，转而使用域名为键。</p>
</blockquote>
<h3 id="旧的方案"><a href="#旧的方案" class="headerlink" title="旧的方案"></a>旧的方案</h3><p>如图，之前是根据用户主机的IP作为唯一性判断，所以将IP作为键，每一个用户IP对应的值都为一个新的HashMap，该Map下再去存放以域名为键，解析的地址为值的数据。</p>
<p><img src="http://oss.fangxinqian.cn/e13cdb1b707c415e94ffac26fd1e981f.jpg" alt="1.pic.jpg"></p>
<h3 id="新的方案"><a href="#新的方案" class="headerlink" title="新的方案"></a>新的方案</h3><p>利用HashMap键的唯一性，将域名作为键，其值为新的HashMap，并存放如下键值对数据：</p>
<pre><code>&quot;ip&quot; =&gt; &quot;1.2.3.4&quot;,&quot;userNumber&quot; =&gt; &quot;LM123123123&quot;</code></pre><p>更改后的结构如下图所示：</p>
<p><img src="http://oss.fangxinqian.cn/b4eca2f32c77449d8595a4ba94759880.jpg" alt="1.pic.jpg"></p>
<h3 id="缘由"><a href="#缘由" class="headerlink" title="缘由"></a>缘由</h3>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/articles/2017/07/27/1501137632912.html/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.liumapp.com/articles/2017/07/26/1501032027293.html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="liumapp">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="liumapp">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/articles/2017/07/26/1501032027293.html/" class="post-title-link" itemprop="url">DNSBrood开发日志——UDP模块的DNSQueen无响应问题</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-07-26 09:22:59" itemprop="dateCreated datePublished" datetime="2017-07-26T09:22:59+08:00">2017-07-26</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>这个问题只发生了一次，暂时还没有找到原因和解决方案，先留一个坑</p>
</blockquote>
<h3 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h3><p>第二天一早检查系统，发现负责UDP模块的DNSQueen项目无响应，日志上也没有发现任何异常报出…</p>
<p>且使用</p>
<pre><code>lsof -i:40310 </code></pre><p>得到程序的pid后使用kill命令无法杀死。</p>
<p>在使用</p>
<pre><code>kill -9 pid</code></pre><p>后才可以杀死进程。</p>
<p>重启程序后恢复正常。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/articles/2017/07/26/1501032027293.html/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.liumapp.com/articles/2017/07/25/1500970083226.html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="liumapp">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="liumapp">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/articles/2017/07/25/1500970083226.html/" class="post-title-link" itemprop="url">DNSBrood开发日志——确保数据库连接的等待时间足够长</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2017-07-25 16:24:28 / 修改时间：16:40:16" itemprop="dateCreated datePublished" datetime="2017-07-25T16:24:28+08:00">2017-07-25</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>做DNS Server已经快一个月了，期间遇到各种各样零零碎碎的问题，我觉得以日志的形式记录下来应该能够有所帮助。</p>
</blockquote>
<h3 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h3><p>目前项目已经达到正向解析及记录的添加删除能够正常执行的阶段，不过今天在测试添加用户唯一标识的时候突然报出下列错误：</p>
<pre><code>17-07-25 15:09:07,476 WARN  com.liumapp.DNSQueen.worker.process.WokerEar(WokerEar.java:96) ## Oops! Maybe not inited 
org.springframework.dao.DataAccessResourceFailureException: 
### Error querying database.  Cause: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: The last packet successfully received from the server was 88,402,280 milliseconds ago.  The last packet sent successfully to the server was 88,402,280 milliseconds ago. is longer than the server configured value of &apos;wait_timeout&apos;. You should consider either expiring and/or testing connection validity before use in your application, increasing the server configured values for client timeouts, or using the Connector/J connection property &apos;autoReconnect=true&apos; to avoid this problem.
### The error may exist in com/liumapp/DNSBrood/dao/ZonesDAO.java (best guess)
### The error may involve com.liumapp.DNSBrood.dao.ZonesDAO.getByDomain-Inline
### The error occurred while setting parameters
### SQL: select * from zones where domain=?
### Cause: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: The last packet successfully received from the server was 88,402,280 milliseconds ago.  The last packet sent successfully to the server was 88,402,280 milliseconds ago. is longer than the server configured value of &apos;wait_timeout&apos;. You should consider either expiring and/or testing connection validity before use in your application, increasing the server configured values for client timeouts, or using the Connector/J connection property &apos;autoReconnect=true&apos; to avoid this problem.
; SQL []; The last packet successfully received from the server was 88,402,280 milliseconds ago.  The last packet sent successfully to the server was 88,402,280 milliseconds ago. is longer than the server configured value of &apos;wait_timeout&apos;. You should consider either expiring and/or testing connection validity before use in your application, increasing the server configured values for client timeouts, or using the Connector/J connection property &apos;autoReconnect=true&apos; to avoid this problem.; nested exception is com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: The last packet successfully received from the server was 88,402,280 milliseconds ago.  The last packet sent successfully to the server was 88,402,280 milliseconds ago. is longer than the server configured value of &apos;wait_timeout&apos;. You should consider either expiring and/or testing connection validity before use in your application, increasing the server configured values for client timeouts, or using the Connector/J connection property &apos;autoReconnect=true&apos; to avoid this problem.</code></pre><h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><p>这么长一段，其实就一个com.mysql.jdbc.exceptions.jdbc4.CommunicationsException，分析了一下，DNS Server肯定要长期运行在服务器中，而系统对Mysql的操作却并不一定经常触发，如果两次触发的时间超过了mysql允许的最久等待时间，那么程序跟Mysql的连接将会断开，从而报出异常。这个问题即使设定tomcat的autoReconnect=true也不能够妥善解决，最好的办法就是修改mysql的默认允许的最长连接时间为1个月。（或者你也可以再设置长一点，但是1个月应该足够了）</p>
<h3 id="具体操作"><a href="#具体操作" class="headerlink" title="具体操作"></a>具体操作</h3><p>首先要确定一下问题的产生确实是由于Mysql引起的，在Mysql命令shell中敲以下命令：</p>
<pre><code>show global variables like &apos;wait_timeout&apos;; </code></pre><p>不出意外，出来的值应该为“28800”秒，也就是8个小时。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/articles/2017/07/25/1500970083226.html/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.liumapp.com/articles/2017/07/25/1500945068899.html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="liumapp">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="liumapp">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/articles/2017/07/25/1500945068899.html/" class="post-title-link" itemprop="url">No thread-bound request found</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-07-25 09:14:55" itemprop="dateCreated datePublished" datetime="2017-07-25T09:14:55+08:00">2017-07-25</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>在Spring框架下使用filter引起的一个错误</p>
</blockquote>
<p>在web.xml配置文件中有如下代码：</p>
<pre><code>&lt;filter&gt;
    &lt;filter-name&gt;LoginRequireFilter&lt;/filter-name&gt;
    &lt;filter-class&gt;com.liumapp.DNSBee.filter.LoginRequireFilter&lt;/filter-class&gt;
    &lt;init-param&gt;
        &lt;param-name&gt;noCheckPath&lt;/param-name&gt;
        &lt;param-value&gt;login;register;nav&lt;/param-value&gt;
    &lt;/init-param&gt;
&lt;/filter&gt;
&lt;filter-mapping&gt;
    &lt;filter-name&gt;LoginRequireFilter&lt;/filter-name&gt;
    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;</code></pre><p>很简单的登录过滤器，但是在运行时报出</p>
<p>HTTP Status 500 - No thread-bound request found: Are you referring to request attributes outside of an actual web request, or processing a request outside of the originally receiving thread? If you are actually operating within a web request and still receive this message, your code is probably running outside of DispatcherServlet/DispatcherPortlet: In this case, use RequestContextListener or RequestContextFilter to expose the current request.</p>
<p>的错误。</p>
<p>解决办法：</p>
<p>在上面的filter之前加入一段：</p>
<pre><code>&lt;listener&gt;
    &lt;listener-class&gt;org.springframework.web.context.request.RequestContextListener&lt;/listener-class&gt;
&lt;/listener&gt;</code></pre>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/articles/2017/07/25/1500945068899.html/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.liumapp.com/articles/2017/07/21/1500597644139.html/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="liumapp">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="liumapp">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/articles/2017/07/21/1500597644139.html/" class="post-title-link" itemprop="url">分享一个亲测可用的VPN工具</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-07-21 08:40:44" itemprop="dateCreated datePublished" datetime="2017-07-21T08:40:44+08:00">2017-07-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2017-07-25 09:15:33" itemprop="dateModified" datetime="2017-07-25T09:15:33+08:00">2017-07-25</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>听说看世界的眼睛被戳瞎了？没事，补补还能用</p>
</blockquote>
<p><a href="https://github.com/getlantern/lantern" target="_blank" rel="noopener">lantern</a></p>

          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/articles/2017/07/21/1500597644139.html/#more" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/10/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><span class="page-number current">11</span><a class="page-number" href="/page/12/">12</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/">17</a><a class="extend next" rel="next" href="/page/12/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">liumapp</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">165</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">88</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">liumapp.com@gmail.com</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v4.2.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.7.0
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
